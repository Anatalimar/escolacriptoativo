<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz sobre Criptoativos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        .quiz-container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
            margin-top: 60px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .start-screen {
            text-align: center;
        }
        .start-screen input {
            padding: 10px;
            margin-bottom: 15px;
            width: 100%;
            max-width: 300px;
        }
        .question {
            margin-bottom: 15px;
        }
        .options label {
            display: block;
            margin: 5px 0;
        }
        button {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            text-align: center;
            font-size: 18px;
            color: #333;
        }
        .timer {
            text-align: center;
            font-size: 18px;
            color: #d9534f;
            margin-bottom: 10px;
        }
        /* Estilo do ranking */
        .ranking-container {
            max-width: 600px;
            margin: auto;
            background: linear-gradient(to bottom, #ffffff, #f9f9f9);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid #ddd;
        }
        .ranking-header {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #007bff;
        }
        .rank-list {
            margin-top: 20px;
            text-align: left;
        }
        .rank-item {
            margin: 10px 0;
            display: flex;
            align-items: center;
            font-size: 16px;
        }
        .rank-stars {
            margin-left: 10px;
            color: gold;
            font-size: 18px;
        }
        .rank-item:nth-child(1) .rank-stars {
            color: gold; /* Primeiro lugar: ouro */
        }
        .rank-item:nth-child(2) .rank-stars {
            color: silver; /* Segundo lugar: prata */
        }
        .rank-item:nth-child(3) .rank-stars {
            color: #cd7f32; /* Terceiro lugar: bronze */
        }
        .rank-item:nth-child(n+4) .rank-stars {
            color: #ccc; /* Demais posições: cinza */
        }
        .rank-details {
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Tela inicial -->
    <div class="quiz-container">
        <div id="start-screen" class="start-screen">
            <h1>Quiz sobre Criptoativos</h1>
            <p>Insira seu nome para começar:</p>
            <input type="text" id="username" placeholder="Seu nome" required>
            <button id="start-btn">Começar Quiz</button>
        </div>
        <!-- Quiz -->
        <div id="quiz" style="display: none;">
            <h1>Quiz sobre Criptoativos</h1>
            <div class="timer" id="timer"></div>
            <div id="question-container"></div>
            <button id="confirm-btn" style="display: none;">Confirmar Resposta</button>
        </div>
        <!-- Resultado -->
        <div id="result-screen" style="display: none;">
            <div class="result" id="result"></div>
            <div class="ranking" id="ranking"></div>
        </div>
    </div>
    <!-- Ranking (fora do quiz-container) -->
    <div class="ranking-container">
        <div class="ranking-header">Ranking dos Jogadores</div>
        <div id="ranking-display" class="rank-list"></div>
    </div>
    <script>
        // Banco de questões
        const allQuestions = [
            {
                question: "O que é Bitcoin?",
                options: ["a) Uma moeda digital descentralizada.", "b) Um banco digital.", "c) Uma plataforma de investimento.", "d) Um aplicativo de mensagens criptografadas."],
                answer: "a"
            },
            {
                question: "Qual blockchain foi projetada para suportar contratos inteligentes?",
                options: ["a) Bitcoin", "b) Ethereum", "c) Dogecoin", "d) Litecoin"],
                answer: "b"
            },
            {
                question: "O que são 'altcoins'?",
                options: ["a) Moedas digitais emitidas por governos.", "b) Todas as criptomoedas exceto o Bitcoin.", "c) Tokens de utilidade usados apenas em jogos.", "d) Contratos inteligentes."],
                answer: "b"
            },
            {
                question: "O que significa 'HODL' no contexto de criptoativos?",
                options: ["a) Um erro de digitação que virou meme.", "b) 'Hold On for Dear Life' (Segure por querida vida).", "c) Um novo tipo de criptomoeda.", "d) Uma técnica de mineração."],
                answer: "b"
            },
            {
                question: "O que é um contrato inteligente?",
                options: ["a) Um acordo verbal entre duas partes.", "b) Um programa autônomo que executa condições pré-definidas.", "c) Um contrato físico registrado em blockchain.", "d) Um token específico."],
                answer: "b"
            },
            {
                question: "Qual é o principal uso do token ERC-20?",
                options: ["a) Mineração de Bitcoin.", "b) Criação de tokens personalizados na rede Ethereum.", "c) Pagamento de taxas de transação.", "d) Armazenamento de dados."],
                answer: "b"
            },
            {
                question: "O que é Proof of Work (PoW)?",
                options: ["a) Um método de consenso usado para validar transações.", "b) Um tipo de contrato inteligente.", "c) Uma carteira de criptomoedas.", "d) Uma ferramenta de análise de mercado."],
                answer: "a"
            },
            {
                question: "O que é uma carteira fria?",
                options: ["a) Uma carteira digital conectada à internet.", "b) Uma carteira física usada para armazenar dinheiro.", "c) Uma carteira offline usada para armazenar criptomoedas.", "d) Uma carteira de papel com senhas escritas."],
                answer: "c"
            },
            {
                question: "O que é DeFi?",
                options: ["a) Uma forma de financiamento centralizado.", "b) Finanças descentralizadas baseadas em blockchain.", "c) Um tipo de criptomoeda.", "d) Um protocolo de mineração."],
                answer: "b"
            },
            {
                question: "O que é staking em criptomoedas?",
                options: ["a) Comprar criptomoedas para investimento.", "b) Bloquear criptomoedas para ganhar recompensas.", "c) Minerar novas moedas.", "d) Vender criptomoedas rapidamente."],
                answer: "b"
            },
            {
                question: "O que é NFT?",
                options: ["a) Um tipo de contrato inteligente.", "b) Uma criptomoeda estável.", "c) Token não fungível usado para representar ativos únicos.", "d) Uma carteira de hardware."],
                answer: "c"
            },
            {
                question: "Qual é o papel dos mineradores em uma blockchain?",
                options: ["a) Validar transações e adicionar blocos.", "b) Criar novas criptomoedas.", "c) Negociar criptomoedas.", "d) Desenvolver contratos inteligentes."],
                answer: "a"
            },
            {
                question: "O que é uma stablecoin?",
                options: ["a) Uma criptomoeda volátil.", "b) Uma criptomoeda vinculada a um ativo estável, como o dólar.", "c) Um token usado apenas em jogos.", "d) Um contrato inteligente."],
                answer: "b"
            },
            {
                question: "O que é o halving do Bitcoin?",
                options: ["a) Um evento que duplica a oferta de Bitcoin.", "b) Um evento que reduz pela metade a recompensa de mineração.", "c) Um bug no código do Bitcoin.", "d) Um aumento temporário no preço do Bitcoin."],
                answer: "b"
            },
            {
                question: "O que é gas fee na rede Ethereum?",
                options: ["a) A taxa cobrada para realizar transações ou executar contratos inteligentes.", "b) O custo de mineração de Ethereum.", "c) O valor pago para criar um novo token.", "d) O lucro gerado por contratos inteligentes."],
                answer: "a"
            },
            {
                question: "O que é uma blockchain pública?",
                options: ["a) Uma blockchain acessível apenas por empresas.", "b) Uma blockchain aberta para qualquer pessoa participar e verificar transações.", "c) Uma blockchain usada apenas por governos.", "d) Uma blockchain privada para transações secretas."],
                answer: "b"
            },
            {
                question: "O que é uma DAO (Organização Autônoma Descentralizada)?",
                options: ["a) Uma organização controlada por um único líder.", "b) Uma organização governada por regras codificadas em contratos inteligentes.", "c) Uma empresa tradicional de tecnologia.", "d) Um grupo de investidores anônimos."],
                answer: "b"
            },
            {
                question: "O que é o protocolo Lightning Network?",
                options: ["a) Uma solução de escalabilidade para redes de blockchain.", "b) Um novo tipo de criptomoeda.", "c) Um sistema de mineração mais eficiente.", "d) Um contrato inteligente avançado."],
                answer: "a"
            },
            {
                question: "O que é fork em criptomoedas?",
                options: ["a) Um erro crítico na rede.", "b) Uma divisão na blockchain resultando em duas versões diferentes.", "c) Um ataque hacker.", "d) Uma atualização de software irrelevante."],
                answer: "b"
            }
        ];

        // Variáveis globais
        let username = "";
        let selectedQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let timerInterval;

        // Função para formatar a data e hora
        function getFormattedDateTime() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, "0");
            const month = String(now.getMonth() + 1).padStart(2, "0");
            const year = now.getFullYear();
            const hours = String(now.getHours()).padStart(2, "0");
            const minutes = String(now.getMinutes()).padStart(2, "0");
            return `${day}/${month}/${year} ${hours}:${minutes}`;
        }

        // Função para carregar resultados do GitHub
        async function loadRankingFromGitHub() {
            try {
                const response = await fetch('https://api.github.com/repos/anatalimar/escolacriptoativo/contents/ranking.json', {
                    headers: {
                        Authorization: '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',
                        Accept: 'application/vnd.github.v3+json'
                    }
                });

                const data = await response.json();
                const content = JSON.parse(atob(data.content)); // Decodificar base64

                // Exibir ranking
                const rankList = document.getElementById("ranking-display");
                rankList.innerHTML = "";
                if (content.length === 0) {
                    rankList.innerHTML += "<div class='rank-item'>Nenhum resultado registrado ainda.</div>";
                    return;
                }

                content.sort((a, b) => b.score - a.score); // Ordenar por pontuação
                content.forEach((entry, index) => {
                    const stars = getStars(index + 1);
                    rankList.innerHTML += `
                        <div class='rank-item'>
                            ${index + 1}. ${entry.name}: ${entry.score}/20
                            <span class='rank-stars'>${stars}</span>
                            <div class='rank-details'>Concluído em: ${entry.date}</div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error('Erro ao carregar ranking:', error);
            }
        }

        // Função para salvar resultado no GitHub
        async function saveResultToGitHub(name, score) {
            const dateTime = getFormattedDateTime();
            const newResult = { name, score, date: dateTime };

            try {
                // Obter o conteúdo atual do arquivo JSON no GitHub
                const response = await fetch('https://api.github.com/repos/anatalimar/escolacriptoativo/contents/ranking.json', {
                    headers: {
                        Authorization: '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',
                        Accept: 'application/vnd.github.v3+json'
                    }
                });

                const data = await response.json();
                const content = JSON.parse(atob(data.content)); // Decodificar base64

                // Adicionar o novo resultado ao array
                content.push(newResult);

                // Atualizar o arquivo no GitHub
                await fetch('https://api.github.com/repos/anatalimar/escolacriptoativo/contents/ranking.json', {
                    method: 'PUT',
                    headers: {
                        Authorization: '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',
                        Accept: 'application/vnd.github.v3+json'
                    },
                    body: JSON.stringify({
                        message: 'Atualizar ranking',
                        content: btoa(JSON.stringify(content)), // Codificar em base64
                        sha: data.sha // SHA do arquivo atual
                    })
                });

                console.log('Resultado salvo no GitHub!');
            } catch (error) {
                console.error('Erro ao salvar resultado:', error);
            }
        }

        // Função para gerar estrelas com base na posição
        function getStars(position) {
            switch (position) {
                case 1:
                    return "⭐⭐⭐"; // Primeiro lugar
                case 2:
                    return "⭐⭐"; // Segundo lugar
                case 3:
                    return "⭐"; // Terceiro lugar
                default:
                    return ""; // Demais posições
            }
        }

        // Função para iniciar o quiz
        document.getElementById("start-btn").addEventListener("click", () => {
            username = document.getElementById("username").value.trim();
            if (!username) {
                alert("Por favor, insira seu nome.");
                return;
            }
            // Esconder tela inicial e mostrar quiz
            document.getElementById("start-screen").style.display = "none";
            document.getElementById("quiz").style.display = "block";
            // Selecionar 10 questões aleatórias
            selectedQuestions = allQuestions.sort(() => 0.5 - Math.random()).slice(0, 20);
            // Exibir primeira pergunta
            showQuestion();
        });

        // Função para exibir a pergunta atual
        function showQuestion() {
            const questionContainer = document.getElementById("question-container");
            questionContainer.innerHTML = "";
            if (currentQuestionIndex >= selectedQuestions.length) {
                endQuiz();
                return;
            }
            const currentQuestion = selectedQuestions[currentQuestionIndex];
            questionContainer.innerHTML = `
                <p><strong>${currentQuestionIndex + 1}. ${currentQuestion.question}</strong></p>
                <div class="options">
                    ${currentQuestion.options.map(option => `<label><input type="radio" name="q${currentQuestionIndex}" value="${option[0]}"> ${option}</label>`).join("")}
                </div>
            `;
            // Ocultar botão de confirmação inicialmente
            document.getElementById("confirm-btn").style.display = "none";

            // Adicionar evento para mostrar botão de confirmação quando uma resposta for selecionada
            document.querySelectorAll(`input[name="q${currentQuestionIndex}"]`).forEach(input => {
                input.addEventListener("change", () => {
                    document.getElementById("confirm-btn").style.display = "block";
                });
            });

            // Iniciar temporizador
            startTimer();
        }

        // Função para iniciar o temporizador
        function startTimer() {
            let timeLeft = 30; // 30 segundos por pergunta
            document.getElementById("timer").textContent = `Tempo restante: ${timeLeft} segundos`;
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById("timer").textContent = `Tempo restante: ${timeLeft} segundos`;
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    nextQuestion();
                }
            }, 1000);
        }

        // Função para ir para a próxima pergunta
        function nextQuestion() {
            clearInterval(timerInterval);
            // Verificar resposta
            const currentQuestion = selectedQuestions[currentQuestionIndex];
            const selectedOption = document.querySelector(`input[name="q${currentQuestionIndex}"]:checked`);
            if (selectedOption && selectedOption.value === currentQuestion.answer) {
                score++;
            }
            // Avançar para a próxima pergunta
            currentQuestionIndex++;
            showQuestion();
        }

        // Evento para confirmar resposta
        document.getElementById("confirm-btn").addEventListener("click", () => {
            nextQuestion();
        });

        // Função para encerrar o quiz
        function endQuiz() {
            clearInterval(timerInterval);
            // Esconder quiz e mostrar resultado
            document.getElementById("quiz").style.display = "none";
            document.getElementById("result-screen").style.display = "block";
            // Salvar resultado no GitHub
            saveResultToGitHub(username, score);
            // Exibir resultado
            document.getElementById("result").textContent = `Sua pontuação: ${score}/20`;
            // Exibir ranking
            const rankingDiv = document.getElementById("ranking");
            if (score >= 18) {
                rankingDiv.textContent = `${username}, você é um Mestre em Criptoativos!`;
            } else if (score >= 10) {
                rankingDiv.textContent = `${username}, você é um Especialista.`;
            } else if (score >= 5) {
                rankingDiv.textContent = `${username}, você é um Iniciante Avançado.`;
            } else {
                rankingDiv.textContent = `${username}, você é um Novato.`;
            }
            // Carregar ranking do GitHub
            loadRankingFromGitHub();
        }

        // Carregar ranking ao carregar a página
        window.onload = loadRankingFromGitHub;
    </script>
</body>
</html>
